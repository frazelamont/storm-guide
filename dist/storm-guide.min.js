!function(t,e){"object"==typeof exports?module.exports=e():t.StormGeocoder=e()}(this,function(){"use strict";function t(t){return Object.assign(Object.create(r),{settings:Object.assign({},e,t)}).init()}var e={linkClassName:".js-guide__link",sectionClassName:".js-guide__section",incrementalNavHolder:".js-guide__incremental",activeClassName:"active"},i=location.hash.slice(1)||null,n={previousNav:['<a href="{{link}}" rel="previous" class="js-guide__incremental--previous nav-incremental-link page-navigation__prev">','<div class="nav-incremental__part">Part {{num}}</div>','<div class="nav-incremental__title">{{title}}</div>',"</div>"].join(""),nextNav:['<a href="{{link}}" rel="next" class="js-guide__incremental--previous nav-incremental-link page-navigation__prev">','<div class="nav-incremental__part">Part {{num}}</div>','<div class="nav-incremental__title">{{title}}</div>',"</div>"].join("")},s=function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t=t.split("{{"+i+"}}").join(e[i]));return t},r={init:function(){if(this.links=[].slice.call(document.querySelectorAll(this.settings.linkClassName))||null,this.sections=[].slice.call(document.querySelectorAll(this.settings.sectionClassName)),this.incrementalNavHolder=document.querySelector(this.settings.incrementalNavHolder)||null,this.currentIndex=0,this.currentTitle="",!this.links||!this.sections||!this.incrementalNavHolder)throw new Error("Guide could not be initialised, ");this.setInitialState(),this.setVisibility(),this.setAria(),this.renderIncrementalNav()},setInitialState:function(){this.links.forEach(function(t,e){t.getAttribute("href").substr(1)===i&&(this.currentIndex=e,this.currentTitle=t.innerText)}.bind(this)),this.currentTitle?this.currentTitle:this.links[this.currentIndex].innerText},setVisibility:function(t){void 0!==t&&(this.links[t].classList.remove(this.settings.activeClassName),this.sections[t].classList.remove(this.settings.activeClassName)),this.links[this.currentIndex].classList.add(this.settings.activeClassName),this.sections[this.currentIndex].classList.add(this.settings.activeClassName),window.setTimeout(function(){window.scrollTo(0,0)},0)},setAria:function(){this.links.forEach(function(t,e){STORM.UTILS.attributelist.set(t,{"aria-selected":this.currentIndex===e,"aria-controls":t.getAttribute("href").substr(1)})}.bind(this)),this.sections.forEach(function(t,e){STORM.UTILS.attributelist.set(t,{"aria-hidden":!(this.currentIndex===e)})}.bind(this))},renderIncrementalNav:function(){var t="",e=function(t){return{link:this.links[t].href,num:t+1,title:this.links[t].innerText}}.bind(this);this.currentIndex>0&&(t=s(n.previousNav,e(this.currentIndex-1))),this.currentIndex!==this.links.length-1&&(t+=s(n.nextNav,e(this.currentIndex+1))),this.incrementalNavHolder.innerHTML=t,this.bindEvents()},bindEvents:function(){[].slice.call(document.querySelectorAll(".js-guide__incremental--previous, .js-guide__incremental--next, .js-guide__link")).forEach(function(t){t.addEventListener("click",this.change.bind(this))}.bind(this))},change:function(t){t.preventDefault();var e=this.currentIndex,i=(t.target.parentNode.getAttribute("href")||t.target.getAttribute("href")).split("#")[1],n=this.getNextIndex("#"+i);e!==n&&(this.currentIndex=n,this.setVisibility(e),this.setAria(),this.renderIncrementalNav(),window.history.pushState({URL:"#"+i},"","#"+i))},getNextIndex:function(t){var e=null;return this.links.forEach(function(i,n){i.getAttribute("href")===t&&(e=n)}),e}};return{init:t}});