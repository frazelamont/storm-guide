(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

var _stormGuide = require('./libs/storm-guide');

var _stormGuide2 = _interopRequireDefault(_stormGuide);

function _interopRequireDefault(obj) {
	return obj && obj.__esModule ? obj : { default: obj };
}

var onDOMContentLoadedTasks = [function () {
	var guide = _stormGuide2.default.init();
	console.log(guide);
}];

if ('addEventListener' in window) window.addEventListener('DOMContentLoaded', function () {
	onDOMContentLoadedTasks.forEach(function (fn) {
		return fn();
	});
});

},{"./libs/storm-guide":2}],2:[function(require,module,exports){
(function (global){
'use strict';

Object.defineProperty(exports, "__esModule", {
	value: true
});
/**
 * @name storm-guide: GDS Guide page-like implementation
 * @version 0.1.1: Fri, 06 Jan 2017 17:16:09 GMT
 * @author stormid
 * @license MIT
 */
var CONSTANTS = {
	TRIGGER_EVENTS: ['click', 'keydown'],
	TRIGGER_KEYCODES: [13, 32]
},
    defaults = {
	linkClassName: '.js-guide__link',
	sectionClassName: '.js-guide__section',
	incrementalNavHolder: '.js-guide__incremental',
	activeClassName: 'active'
},
    hash = global.location && global.location.hash.slice(1) || null,
    templates = {
	previousNav: ['<a href="{{link}}" rel="previous" class="js-guide__incremental--previous nav-incremental-link page-navigation__prev">', '<div class="nav-incremental__part">Part {{num}}</div>', '<div class="nav-incremental__title">{{title}}</div>', '</div>'].join(''),
	nextNav: ['<a href="{{link}}" rel="next" class="js-guide__incremental--previous nav-incremental-link page-navigation__prev">', '<div class="nav-incremental__part">Part {{num}}</div>', '<div class="nav-incremental__title">{{title}}</div>', '</div>'].join('')
},
    render = function render(template, data) {
	for (var k in data) {
		if (data.hasOwnProperty(k)) {
			template = template.split('{{' + k + '}}').join(data[k]);
		}
	}
	return template;
};

var StormGuide = {
	init: function init() {
		if (global.location) global.location.hash = '';

		this.links = [].slice.call(document.querySelectorAll(this.settings.linkClassName)) || null;
		this.sections = [].slice.call(document.querySelectorAll(this.settings.sectionClassName));
		this.incrementalNavHolder = document.querySelector(this.settings.incrementalNavHolder) || null;
		this.currentIndex = 0;
		this.currentTitle = '';

		if (!this.links.length || !this.sections.length || !this.incrementalNavHolder) throw new Error('Guide could not be initialised, ');

		this.setInitialState();
		this.setVisibility();
		this.setAria();
		this.renderIncrementalNav();
		this.bindEvents('.js-guide__link');

		return this;
	},
	setInitialState: function setInitialState() {
		var _this = this;

		this.links.forEach(function (link, i) {
			if (link.getAttribute('href').substr(1) === hash) {
				_this.currentIndex = i;
				_this.currentTitle = link.innerText;
			}
		});
		!this.currentTitle ? this.links[this.currentIndex].innerText : this.currentTitle;
	},
	setVisibility: function setVisibility(previousIndex) {
		if (previousIndex !== undefined) {
			this.links[previousIndex].classList.remove(this.settings.activeClassName);
			this.sections[previousIndex].classList.remove(this.settings.activeClassName);
		}
		this.links[this.currentIndex].classList.add(this.settings.activeClassName);
		this.sections[this.currentIndex].classList.add(this.settings.activeClassName);

		window.scrollTo(0, 0);
		window.setTimeout(function () {
			if (hash && global.location.hash === '') !!window.history && !!window.history.pushState && window.history.pushState({ URL: '#' + hash }, '', '#' + hash);
			window.scrollTo(0, 0);
		}, 0);
	},
	setAria: function setAria() {
		for (var i = 0; i < this.links.length; i++) {
			this.links[i].setAttribute('aria-selected', this.currentIndex === i);
			this.links[i].setAttribute('aria-controls', this.links[i].getAttribute('href').substr(1));
			this.sections[i].setAttribute('aria-hidden', !(this.currentIndex === i));
		}
	},
	renderIncrementalNav: function renderIncrementalNav() {
		var _this2 = this;

		var incrementalNav = '',
		    getNavData = function getNavData(i) {
			return {
				link: _this2.links[i].href,
				num: i + 1,
				title: _this2.links[i].innerText
			};
		};

		if (this.currentIndex > 0) incrementalNav = render(templates.previousNav, getNavData(this.currentIndex - 1));

		if (this.currentIndex !== this.links.length - 1) incrementalNav += render(templates.nextNav, getNavData(this.currentIndex + 1));

		this.incrementalNavHolder.innerHTML = incrementalNav;
		this.bindEvents('.js-guide__incremental--previous, .js-guide__incremental--next');
	},
	bindEvents: function bindEvents(sel) {
		var _this3 = this;

		[].slice.call(document.querySelectorAll(sel)).forEach(function (btn) {
			CONSTANTS.TRIGGER_EVENTS.forEach(function (ev) {
				btn.addEventListener(ev, function (e) {
					if (!!e.keyCode && !~CONSTANTS.TRIGGER_KEYCODES.indexOf(e.keyCode)) return;
					e.preventDefault();
					_this3.change(e.target);
				});
			});
		});
	},
	change: function change(link) {
		var previousIndex = this.currentIndex,
		    nextUrl = (link.parentNode.getAttribute('href') || link.getAttribute('href')).split('#')[1],
		    nextIndex = this.getNextIndex('#' + nextUrl);

		if (previousIndex === nextIndex) return;

		this.currentIndex = nextIndex;
		this.setVisibility(previousIndex);
		this.setAria();
		this.renderIncrementalNav();

		!!window.history && !!window.history.pushState && window.history.pushState({ URL: '#' + nextUrl }, '', '#' + nextUrl);
	},
	getNextIndex: function getNextIndex(href) {
		return this.links.reduce(function (a, link, i) {
			if (link.getAttribute('href') === href) a.push(i);return a;
		}, [])[0];
	}
};

var init = function init(opts) {
	return Object.assign(Object.create(StormGuide), {
		settings: Object.assign({}, defaults, opts)
	}).init();
};

exports.default = { init: init };

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJleGFtcGxlL3NyYy9hcHAuanMiLCJleGFtcGxlL3NyYy9saWJzL3N0b3JtLWd1aWRlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNBQTs7Ozs7Ozs7QUFFQSxJQUFNLDJCQUEyQixZQUFNLEFBQ3RDO0tBQUksUUFBUSxxQkFBWixBQUFZLEFBQU0sQUFDbEI7U0FBQSxBQUFRLElBQVIsQUFBWSxBQUNaO0FBSEQsQUFBZ0MsQ0FBQTs7QUFLaEMsSUFBRyxzQkFBSCxBQUF5QixlQUFRLEFBQU8saUJBQVAsQUFBd0Isb0JBQW9CLFlBQU0sQUFBRTt5QkFBQSxBQUF3QixRQUFRLFVBQUEsQUFBQyxJQUFEO1NBQUEsQUFBUTtBQUF4QyxBQUFnRDtBQUFwRyxDQUFBOzs7Ozs7Ozs7QUNQakM7Ozs7OztBQU1BLElBQU07aUJBQ1ksQ0FBQSxBQUFDLFNBREQsQUFDQSxBQUFVLEFBQzFCO21CQUFrQixDQUFBLEFBQUMsSUFGckIsQUFBa0IsQUFFRSxBQUFLO0FBRlAsQUFDaEI7SUFHRDtnQkFBVyxBQUNLLEFBQ2Y7bUJBRlUsQUFFUSxBQUNsQjt1QkFIVSxBQUdZLEFBQ3RCO2tCQVJGLEFBSVksQUFJTztBQUpQLEFBQ1Y7SUFLRCxPQUFRLE9BQUEsQUFBTyxZQUFZLE9BQUEsQUFBTyxTQUFQLEFBQWdCLEtBQWhCLEFBQXFCLE1BQXpDLEFBQW9CLEFBQTJCLE1BVnZELEFBVThEO0lBQzdEO2NBQ2MsQ0FBQSxBQUFDLHlIQUFELEFBQ1QseURBRFMsQUFFVCx1REFGUyxBQUdULFVBSFMsQUFHQyxLQUpILEFBQ0UsQUFHTSxBQUNuQjtVQUFTLENBQUEsQUFBQyxxSEFBRCxBQUNMLHlEQURLLEFBRUwsdURBRkssQUFHTCxVQUhLLEFBR0ssS0FuQmhCLEFBV2EsQUFLRixBQUdVO0FBUlIsQUFDWDtJQVNELFNBQVMsU0FBVCxBQUFTLE9BQUEsQUFBUyxVQUFULEFBQW1CLE1BQUssQUFD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UCxBQUFlLFVBQVUsRUFBRSxLQUFLLE1BQWhDLEFBQXlCLEFBQWEsV0FBdEMsQUFBaUQsSUFBSSxNQUF6RyxBQUFvRCxBQUEyRCxBQUMvRztBQTVGaUIsQUE2RmxCO0FBN0ZrQixxQ0FBQSxBQTZGTCxNQUFLLEFBQ2pCO2NBQU8sQUFBSyxNQUFMLEFBQVcsT0FBTyxVQUFBLEFBQUMsR0FBRCxBQUFJLE1BQUosQUFBVSxHQUFNLEFBQUU7T0FBRyxLQUFBLEFBQUssYUFBTCxBQUFrQixZQUFyQixBQUFpQyxNQUFNLEVBQUEsQUFBRSxLQUFGLEFBQU8sR0FBSSxPQUFBLEFBQU8sQUFBSTtBQUFqRyxHQUFBLEVBQUEsQUFBbUcsSUFBMUcsQUFBTyxBQUF1RyxBQUM5RztBQS9GRixBQUFtQjtBQUFBLEFBQ2xCOztBQWlHRCxJQUFNLE9BQU8sU0FBUCxBQUFPLFdBQVEsQUFDcEI7ZUFBTyxBQUFPLE9BQU8sT0FBQSxBQUFPLE9BQXJCLEFBQWMsQUFBYztZQUN4QixPQUFBLEFBQU8sT0FBUCxBQUFjLElBQWQsQUFBa0IsVUFEdEIsQUFBeUMsQUFDckMsQUFBNEI7QUFEUyxBQUMvQyxFQURNLEVBQVAsQUFBTyxBQUVKLEFBQ0g7QUFKRDs7a0JBTWUsRUFBRSxNLEFBQUYiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiaW1wb3J0IEd1aWRlIGZyb20gJy4vbGlicy9zdG9ybS1ndWlkZSc7XG5cbmNvbnN0IG9uRE9NQ29udGVudExvYWRlZFRhc2tzID0gWygpID0+IHtcblx0bGV0IGd1aWRlID0gR3VpZGUuaW5pdCgpO1xuXHRjb25zb2xlLmxvZyhndWlkZSk7XG59XTtcbiAgICBcbmlmKCdhZGRFdmVudExpc3RlbmVyJyBpbiB3aW5kb3cpIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4geyBvbkRPTUNvbnRlbnRMb2FkZWRUYXNrcy5mb3JFYWNoKChmbikgPT4gZm4oKSk7IH0pOyIsIi8qKlxuICogQG5hbWUgc3Rvcm0tZ3VpZGU6IEdEUyBHdWlkZSBwYWdlLWxpa2UgaW1wbGVtZW50YXRpb25cbiAqIEB2ZXJzaW9uIDAuMS4xOiBGcmksIDA2IEphbiAyMDE3IDE3OjE2OjA5IEdNVFxuICogQGF1dGhvciBzdG9ybWlkXG4gKiBAbGljZW5zZSBNSVRcbiAqL1xuY29uc3QgQ09OU1RBTlRTID0ge1xuXHRcdFRSSUdHRVJfRVZFTlRTOiBbJ2NsaWNrJywgJ2tleWRvd24nXSxcblx0XHRUUklHR0VSX0tFWUNPREVTOiBbMTMsIDMyXVxuXHR9LFxuXHRkZWZhdWx0cyA9IHtcblx0XHRsaW5rQ2xhc3NOYW1lOiAnLmpzLWd1aWRlX19saW5rJyxcblx0XHRzZWN0aW9uQ2xhc3NOYW1lOiAnLmpzLWd1aWRlX19zZWN0aW9uJyxcblx0XHRpbmNyZW1lbnRhbE5hdkhvbGRlcjogJy5qcy1ndWlkZV9faW5jcmVtZW50YWwnLFxuXHRcdGFjdGl2ZUNsYXNzTmFtZTogJ2FjdGl2ZSdcblx0fSxcblx0aGFzaCA9IChnbG9iYWwubG9jYXRpb24gJiYgZ2xvYmFsLmxvY2F0aW9uLmhhc2guc2xpY2UoMSkpIHx8IG51bGwsXG5cdHRlbXBsYXRlcyA9IHtcblx0XHRwcmV2aW91c05hdjogWyc8YSBocmVmPVwie3tsaW5rfX1cIiByZWw9XCJwcmV2aW91c1wiIGNsYXNzPVwianMtZ3VpZGVfX2luY3JlbWVudGFsLS1wcmV2aW91cyBuYXYtaW5jcmVtZW50YWwtbGluayBwYWdlLW5hdmlnYXRpb25fX3ByZXZcIj4nLFxuXHRcdFx0XHRcdFx0JzxkaXYgY2xhc3M9XCJuYXYtaW5jcmVtZW50YWxfX3BhcnRcIj5QYXJ0IHt7bnVtfX08L2Rpdj4nLFxuXHRcdFx0XHRcdFx0JzxkaXYgY2xhc3M9XCJuYXYtaW5jcmVtZW50YWxfX3RpdGxlXCI+e3t0aXRsZX19PC9kaXY+Jyxcblx0XHRcdFx0XHRcdCc8L2Rpdj4nXS5qb2luKCcnKSxcblx0XHRuZXh0TmF2OiBbJzxhIGhyZWY9XCJ7e2xpbmt9fVwiIHJlbD1cIm5leHRcIiBjbGFzcz1cImpzLWd1aWRlX19pbmNyZW1lbnRhbC0tcHJldmlvdXMgbmF2LWluY3JlbWVudGFsLWxpbmsgcGFnZS1uYXZpZ2F0aW9uX19wcmV2XCI+Jyxcblx0XHRcdFx0XHRcdCc8ZGl2IGNsYXNzPVwibmF2LWluY3JlbWVudGFsX19wYXJ0XCI+UGFydCB7e251bX19PC9kaXY+Jyxcblx0XHRcdFx0XHRcdCc8ZGl2IGNsYXNzPVwibmF2LWluY3JlbWVudGFsX190aXRsZVwiPnt7dGl0bGV9fTwvZGl2PicsXG5cdFx0XHRcdFx0XHQnPC9kaXY+J10uam9pbignJylcblx0fSxcblx0cmVuZGVyID0gZnVuY3Rpb24odGVtcGxhdGUsIGRhdGEpe1xuXHRcdGZvcih2YXIgayBpbiBkYXRhKXtcblx0XHRcdGlmKGRhdGEuaGFzT3duUHJvcGVydHkoaykpe1xuXHRcdFx0XHR0ZW1wbGF0ZSA9IHRlbXBsYXRlLnNwbGl0KCd7eycgKyBrICsgJ319Jykuam9pbihkYXRhW2tdKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHRlbXBsYXRlO1xuXHR9O1xuXG5jb25zdCBTdG9ybUd1aWRlID0ge1xuXHRpbml0KCl7XG5cdFx0aWYoZ2xvYmFsLmxvY2F0aW9uKSBnbG9iYWwubG9jYXRpb24uaGFzaCA9ICcnO1xuXG5cdFx0dGhpcy5saW5rcyA9IFtdLnNsaWNlLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLnNldHRpbmdzLmxpbmtDbGFzc05hbWUpKSB8fCBudWxsO1xuXHRcdHRoaXMuc2VjdGlvbnMgPSBbXS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5zZXR0aW5ncy5zZWN0aW9uQ2xhc3NOYW1lKSk7XG5cdFx0dGhpcy5pbmNyZW1lbnRhbE5hdkhvbGRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5zZXR0aW5ncy5pbmNyZW1lbnRhbE5hdkhvbGRlcikgfHwgbnVsbDtcblx0XHR0aGlzLmN1cnJlbnRJbmRleCA9IDA7XG5cdFx0dGhpcy5jdXJyZW50VGl0bGUgPSAnJztcblxuXHRcdGlmKCF0aGlzLmxpbmtzLmxlbmd0aCB8fCAhdGhpcy5zZWN0aW9ucy5sZW5ndGggfHwgIXRoaXMuaW5jcmVtZW50YWxOYXZIb2xkZXIpIHRocm93IG5ldyBFcnJvcignR3VpZGUgY291bGQgbm90IGJlIGluaXRpYWxpc2VkLCAnKTtcblx0XHRcblx0XHR0aGlzLnNldEluaXRpYWxTdGF0ZSgpO1xuXHRcdHRoaXMuc2V0VmlzaWJpbGl0eSgpO1xuXHRcdHRoaXMuc2V0QXJpYSgpO1xuXHRcdHRoaXMucmVuZGVySW5jcmVtZW50YWxOYXYoKTtcblx0XHR0aGlzLmJpbmRFdmVudHMoJy5qcy1ndWlkZV9fbGluaycpO1xuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdFx0XG5cdH0sXG5cdHNldEluaXRpYWxTdGF0ZSgpe1xuXHRcdHRoaXMubGlua3MuZm9yRWFjaCgobGluaywgaSkgPT4ge1xuXHRcdFx0aWYobGluay5nZXRBdHRyaWJ1dGUoJ2hyZWYnKS5zdWJzdHIoMSkgPT09IGhhc2gpIHtcblx0XHRcdFx0dGhpcy5jdXJyZW50SW5kZXggPSBpO1xuXHRcdFx0XHR0aGlzLmN1cnJlbnRUaXRsZSA9IGxpbmsuaW5uZXJUZXh0O1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdCF0aGlzLmN1cnJlbnRUaXRsZSA/IHRoaXMubGlua3NbdGhpcy5jdXJyZW50SW5kZXhdLmlubmVyVGV4dCA6IHRoaXMuY3VycmVudFRpdGxlO1xuXHR9LFxuXHRzZXRWaXNpYmlsaXR5KHByZXZpb3VzSW5kZXgpe1xuXHRcdGlmKHByZXZpb3VzSW5kZXggIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0dGhpcy5saW5rc1twcmV2aW91c0luZGV4XS5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuc2V0dGluZ3MuYWN0aXZlQ2xhc3NOYW1lKTtcblx0XHRcdHRoaXMuc2VjdGlvbnNbcHJldmlvdXNJbmRleF0uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLnNldHRpbmdzLmFjdGl2ZUNsYXNzTmFtZSk7XG5cdFx0fVxuXHRcdHRoaXMubGlua3NbdGhpcy5jdXJyZW50SW5kZXhdLmNsYXNzTGlzdC5hZGQodGhpcy5zZXR0aW5ncy5hY3RpdmVDbGFzc05hbWUpO1xuXHRcdHRoaXMuc2VjdGlvbnNbdGhpcy5jdXJyZW50SW5kZXhdLmNsYXNzTGlzdC5hZGQodGhpcy5zZXR0aW5ncy5hY3RpdmVDbGFzc05hbWUpO1xuXHRcdFxuXHRcdHdpbmRvdy5zY3JvbGxUbygwLDApO1xuXHRcdHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdGlmKGhhc2ggJiYgZ2xvYmFsLmxvY2F0aW9uLmhhc2ggPT09ICcnKSAgKCEhd2luZG93Lmhpc3RvcnkgJiYgISF3aW5kb3cuaGlzdG9yeS5wdXNoU3RhdGUpICYmIHdpbmRvdy5oaXN0b3J5LnB1c2hTdGF0ZSh7IFVSTDogYCMke2hhc2h9YH0sICcnLCBgIyR7aGFzaH1gKTtcblx0XHRcdHdpbmRvdy5zY3JvbGxUbygwLDApO1xuXHRcdH0sIDApO1xuXHR9LFxuXHRzZXRBcmlhKCl7XG5cdFx0Zm9yKGxldCBpID0gMDsgaSA8IHRoaXMubGlua3MubGVuZ3RoOyBpKyspe1xuXHRcdFx0dGhpcy5saW5rc1tpXS5zZXRBdHRyaWJ1dGUoJ2FyaWEtc2VsZWN0ZWQnLCB0aGlzLmN1cnJlbnRJbmRleCA9PT0gaSk7XG5cdFx0XHR0aGlzLmxpbmtzW2ldLnNldEF0dHJpYnV0ZSgnYXJpYS1jb250cm9scycsIHRoaXMubGlua3NbaV0uZ2V0QXR0cmlidXRlKCdocmVmJykuc3Vic3RyKDEpKTtcblx0XHRcdHRoaXMuc2VjdGlvbnNbaV0uc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICEodGhpcy5jdXJyZW50SW5kZXggPT09IGkpKTtcblx0XHR9XG5cdH0sXG5cdHJlbmRlckluY3JlbWVudGFsTmF2KCl7XG5cdFx0dmFyIGluY3JlbWVudGFsTmF2ID0gJycsXG5cdFx0XHRnZXROYXZEYXRhID0gaSA9PiB7XG5cdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0bGluazogdGhpcy5saW5rc1tpXS5ocmVmLFxuXHRcdFx0XHRcdG51bTogaSArIDEsXG5cdFx0XHRcdFx0dGl0bGU6IHRoaXMubGlua3NbaV0uaW5uZXJUZXh0XG5cdFx0XHRcdH07XG5cdFx0XHR9O1xuXHRcdFxuXHRcdGlmKHRoaXMuY3VycmVudEluZGV4ID4gMCkgaW5jcmVtZW50YWxOYXYgPSByZW5kZXIodGVtcGxhdGVzLnByZXZpb3VzTmF2LCBnZXROYXZEYXRhKHRoaXMuY3VycmVudEluZGV4IC0gMSkpO1xuXHRcdFxuXHRcdGlmKHRoaXMuY3VycmVudEluZGV4ICE9PSB0aGlzLmxpbmtzLmxlbmd0aCAtIDEpIGluY3JlbWVudGFsTmF2ICs9IHJlbmRlcih0ZW1wbGF0ZXMubmV4dE5hdiwgZ2V0TmF2RGF0YSh0aGlzLmN1cnJlbnRJbmRleCArIDEpKTtcblx0XHRcblx0XHR0aGlzLmluY3JlbWVudGFsTmF2SG9sZGVyLmlubmVySFRNTCA9IGluY3JlbWVudGFsTmF2O1xuXHRcdHRoaXMuYmluZEV2ZW50cygnLmpzLWd1aWRlX19pbmNyZW1lbnRhbC0tcHJldmlvdXMsIC5qcy1ndWlkZV9faW5jcmVtZW50YWwtLW5leHQnKTtcblx0fSxcblx0YmluZEV2ZW50cyhzZWwpIHtcblx0XHRbXS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsKSkuZm9yRWFjaChidG4gPT4ge1xuXHRcdFx0Q09OU1RBTlRTLlRSSUdHRVJfRVZFTlRTLmZvckVhY2goZXYgPT4ge1xuXHRcdFx0XHRidG4uYWRkRXZlbnRMaXN0ZW5lcihldiwgZSA9PiB7XG5cdFx0XHRcdFx0aWYoISFlLmtleUNvZGUgJiYgIX5DT05TVEFOVFMuVFJJR0dFUl9LRVlDT0RFUy5pbmRleE9mKGUua2V5Q29kZSkpIHJldHVybjtcblx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0dGhpcy5jaGFuZ2UoZS50YXJnZXQpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9LFxuXHRjaGFuZ2UobGluaykge1xuXHRcdGxldCBwcmV2aW91c0luZGV4ID0gdGhpcy5jdXJyZW50SW5kZXgsXG5cdFx0XHRuZXh0VXJsID0gKGxpbmsucGFyZW50Tm9kZS5nZXRBdHRyaWJ1dGUoJ2hyZWYnKSB8fCBsaW5rLmdldEF0dHJpYnV0ZSgnaHJlZicpKS5zcGxpdCgnIycpWzFdLFxuXHRcdFx0bmV4dEluZGV4ID0gdGhpcy5nZXROZXh0SW5kZXgoJyMnICsgbmV4dFVybCk7XG5cdFx0XG5cdFx0aWYocHJldmlvdXNJbmRleCA9PT0gbmV4dEluZGV4KSByZXR1cm47XG5cdFx0XG5cdFx0dGhpcy5jdXJyZW50SW5kZXggPSBuZXh0SW5kZXg7XG5cdFx0dGhpcy5zZXRWaXNpYmlsaXR5KHByZXZpb3VzSW5kZXgpO1xuXHRcdHRoaXMuc2V0QXJpYSgpO1xuXHRcdHRoaXMucmVuZGVySW5jcmVtZW50YWxOYXYoKTtcblxuXHRcdCghIXdpbmRvdy5oaXN0b3J5ICYmICEhd2luZG93Lmhpc3RvcnkucHVzaFN0YXRlKSAmJiB3aW5kb3cuaGlzdG9yeS5wdXNoU3RhdGUoeyBVUkw6ICcjJyArIG5leHRVcmwgfSwgJycsICcjJyArIG5leHRVcmwpO1xuXHR9LFxuXHRnZXROZXh0SW5kZXgoaHJlZil7XG5cdFx0cmV0dXJuIHRoaXMubGlua3MucmVkdWNlKChhLCBsaW5rLCBpKSA9PiB7IGlmKGxpbmsuZ2V0QXR0cmlidXRlKCdocmVmJykgPT09IGhyZWYpIGEucHVzaChpKTsgcmV0dXJuIGE7IH0sIFtdKVswXTtcblx0fVxufTtcblxuY29uc3QgaW5pdCA9IG9wdHMgPT4ge1xuXHRyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKFN0b3JtR3VpZGUpLCB7XG5cdFx0c2V0dGluZ3M6IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRzLCBvcHRzKVxuXHR9KS5pbml0KCk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCB7IGluaXQgfTsiXX0=
